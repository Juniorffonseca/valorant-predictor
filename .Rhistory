hidden = c(10,10),
err.fct = "sse",
linear.output = F,
threshold = 2,
lifesign = 'minimal',
rep = 1,
algorithm = 'rprop-',
stepmax = 1000)
# Modelando a rede neural ---------------------------------------------------------------------------------
n <- neuralnet(ganhador == 1 ~ time1R + time2R + time1ACS + time2ACS + time1KAST + time2KAST + time1KD + time2KD +
time1ADR + time2ADR,
data = training_data,
hidden = c(10,10),
err.fct = "sse",
linear.output = F,
threshold = 2,
lifesign = 'minimal',
rep = 1,
algorithm = 'rprop-',
stepmax = 1000)
# Modelando a rede neural ---------------------------------------------------------------------------------
n <- neuralnet(ganhador == 1 ~ time1R + time2R + time1ACS + time2ACS + time1KAST + time2KAST + time1KD + time2KD +
time1ADR + time2ADR,
data = training_data,
hidden = c(10,10),
err.fct = "sse",
linear.output = F,
threshold = 1,5,
lifesign = 'minimal',
rep = 1,
algorithm = 'rprop-',
stepmax = 1000)
# Modelando a rede neural ---------------------------------------------------------------------------------
n <- neuralnet(ganhador == 1 ~ time1R + time2R + time1ACS + time2ACS + time1KAST + time2KAST + time1KD + time2KD +
time1ADR + time2ADR,
data = training_data,
hidden = c(10,10),
err.fct = "sse",
linear.output = F,
threshold = 1,
lifesign = 'minimal',
rep = 1,
algorithm = 'rprop-',
stepmax = 1000)
# Prediction ---------------------------------------------------------------------------------------------
Predict = compute(n, test_data)
nn2 <- ifelse(Predict$net.result[,1]>mean(Predict$net.result),1,0)
predictVstest <- cbind(test_data, Predict$net.result)
i <<- sum(predictVstest$ganhador == nn2)/ nrow(test_data)
# Modelando a rede neural ---------------------------------------------------------------------------------
n <- neuralnet(ganhador == 1 ~ time1R + time2R + time1ACS + time2ACS + time1KAST + time2KAST + time1KD + time2KD +
time1ADR + time2ADR,
data = training_data,
hidden = c(30,30),
err.fct = "sse",
linear.output = F,
threshold = 1,
lifesign = 'minimal',
rep = 1,
algorithm = 'rprop-',
stepmax = 1000)
# Modelando a rede neural ---------------------------------------------------------------------------------
n <- neuralnet(ganhador == 1 ~ time1R + time2R + time1ACS + time2ACS + time1KAST + time2KAST + time1KD + time2KD +
time1ADR + time2ADR,
data = training_data,
hidden = c(30,30),
err.fct = "sse",
linear.output = F,
threshold = 1.8,
lifesign = 'minimal',
rep = 1,
algorithm = 'rprop-',
stepmax = 1000)
# Prediction ---------------------------------------------------------------------------------------------
Predict = compute(n, test_data)
nn2 <- ifelse(Predict$net.result[,1]>mean(Predict$net.result),1,0)
predictVstest <- cbind(test_data, Predict$net.result)
i <<- sum(predictVstest$ganhador == nn2)/ nrow(test_data)
# Modelando a rede neural ---------------------------------------------------------------------------------
n <- neuralnet(ganhador == 1 ~ time1R + time2R + time1ACS + time2ACS + time1KAST + time2KAST + time1KD + time2KD +
time1ADR + time2ADR,
data = training_data,
hidden = c(70,70),
err.fct = "sse",
linear.output = F,
threshold = 1.8,
lifesign = 'minimal',
rep = 1,
algorithm = 'rprop-',
stepmax = 1000)
# Criando dataframes de teste e validação -----------------------------------------------------------------
set.seed(6)
inp <- sample(2, nrow(jogos), replace = TRUE, prob = c(0.7, 0.3))
training_data <- jogos[inp==1, ]
test_data <- jogos[inp==2, ]
# Normalizando os dados ------------------------------------------------------------------------------------
normalizando_test <- dplyr::select(test_data, -ganhador)
normalizando_test <- as.data.frame(scale(normalizando_test))
test_data <- dplyr::select(test_data, ganhador)
test_data <- cbind(normalizando_test, test_data)
normalizando_training <- dplyr::select(training_data, -ganhador)
normalizando_training <- as.data.frame(scale(normalizando_training))
training_data <- dplyr::select(training_data, ganhador)
training_data <- cbind(normalizando_training, training_data)
training_data$ganhador <- as.factor(training_data$ganhador)
test_data$ganhador <- as.factor(test_data$ganhador)
# Modelando a rede neural ---------------------------------------------------------------------------------
n <- neuralnet(ganhador == 1 ~ time1R + time2R + time1ACS + time2ACS + time1KAST + time2KAST + time1KD + time2KD +
time1ADR + time2ADR,
data = training_data,
hidden = c(70,70),
err.fct = "sse",
linear.output = F,
threshold = 1.8,
lifesign = 'minimal',
rep = 1,
algorithm = 'rprop-',
stepmax = 1000)
# Modelando a rede neural ---------------------------------------------------------------------------------
n <- neuralnet(ganhador == 1 ~ time1R + time2R + time1ACS + time2ACS + time1KAST + time2KAST + time1KD + time2KD +
time1ADR + time2ADR,
data = training_data,
hidden = c(70,70),
err.fct = "sse",
linear.output = F,
threshold = 2,
lifesign = 'minimal',
rep = 1,
algorithm = 'rprop-',
stepmax = 1000)
# Prediction ---------------------------------------------------------------------------------------------
Predict = compute(n, test_data)
nn2 <- ifelse(Predict$net.result[,1]>mean(Predict$net.result),1,0)
predictVstest <- cbind(test_data, Predict$net.result)
i <<- sum(predictVstest$ganhador == nn2)/ nrow(test_data)
# Modelando a rede neural ---------------------------------------------------------------------------------
n <- neuralnet(ganhador == 1 ~ time1R + time2R + time1ACS + time2ACS + time1KAST + time2KAST + time1KD + time2KD +
time1ADR + time2ADR,
data = training_data,
hidden = c(60,60),
err.fct = "sse",
linear.output = F,
threshold = 2,
lifesign = 'minimal',
rep = 1,
algorithm = 'rprop-',
stepmax = 1000)
# Prediction ---------------------------------------------------------------------------------------------
Predict = compute(n, test_data)
nn2 <- ifelse(Predict$net.result[,1]>mean(Predict$net.result),1,0)
predictVstest <- cbind(test_data, Predict$net.result)
i <<- sum(predictVstest$ganhador == nn2)/ nrow(test_data)
# Modelando a rede neural ---------------------------------------------------------------------------------
n <- neuralnet(ganhador == 1 ~ time1R + time2R + time1ACS + time2ACS + time1KAST + time2KAST + time1KD + time2KD +
time1ADR + time2ADR,
data = training_data,
hidden = c(70,70),
err.fct = "sse",
linear.output = F,
threshold = 2,
lifesign = 'minimal',
rep = 1,
algorithm = 'rprop-',
stepmax = 1000)
# Prediction ---------------------------------------------------------------------------------------------
Predict = compute(n, test_data)
nn2 <- ifelse(Predict$net.result[,1]>mean(Predict$net.result),1,0)
predictVstest <- cbind(test_data, Predict$net.result)
i <<- sum(predictVstest$ganhador == nn2)/ nrow(test_data)
acharseed <- function(seed){
set.seed(seed)
inp <- sample(2, nrow(jogos), replace = TRUE, prob = c(0.7, 0.3))
training_data <- jogos[inp==1, ]
test_data <- jogos[inp==2, ]
normalizando_test <- dplyr::select(test_data, -ganhador)
normalizando_test <- as.data.frame(scale(normalizando_test))
test_data <- dplyr::select(test_data, ganhador)
test_data <- cbind(normalizando_test, test_data)
normalizando_training <- dplyr::select(training_data, -ganhador)
normalizando_training <- as.data.frame(scale(normalizando_training))
training_data <- dplyr::select(training_data, ganhador)
training_data <- cbind(normalizando_training, training_data)
training_data$ganhador <- as.factor(training_data$ganhador)
test_data$ganhador <- as.factor(test_data$ganhador)
n <- neuralnet(ganhador == 1 ~ time1R + time2R + time1ACS + time2ACS + time1KAST + time2KAST + time1KD + time2KD +
time1ADR + time2ADR,
data = training_data,
hidden = c(60,60),
err.fct = "sse",
linear.output = F,
threshold = 2,
lifesign = 'minimal',
rep = 1,
algorithm = 'rprop-',
stepmax = 10000)
Predict = compute(n, test_data)
nn2 <- ifelse(Predict$net.result[,1]>mean(Predict$net.result),1,0)
predictVstest <- cbind(test_data, Predict$net.result)
i <<- sum(predictVstest$ganhador == nn2)/ nrow(test_data)
}
s <- 1
while ( i < 0.67) {
acharseed(s)
s <- s + 1
}
# Atualizando a seed para achar a melhor neuralnetwork -----------------------------------------------------
#set.seed(4264)
set.seed(17)
inp <- sample(2, nrow(jogos), replace = TRUE, prob = c(0.7, 0.3))
training_data <- jogos[inp==1, ]
test_data <- jogos[inp==2, ]
normalizando_test <- dplyr::select(test_data, -ganhador)
normalizando_test <- as.data.frame(scale(normalizando_test))
test_data <- dplyr::select(test_data, ganhador)
test_data <- cbind(normalizando_test, test_data)
normalizando_training <- dplyr::select(training_data, -ganhador)
normalizando_training <- as.data.frame(scale(normalizando_training))
training_data <- dplyr::select(training_data, ganhador)
training_data <- cbind(normalizando_training, training_data)
training_data$ganhador <- as.factor(training_data$ganhador)
test_data$ganhador <- as.factor(test_data$ganhador)
acharnn <- function(){
n <- neuralnet(ganhador == 1 ~ time1R + time2R + time1ACS + time2ACS + time1KAST + time2KAST + time1KD + time2KD +
time1ADR + time2ADR,
data = training_data,
hidden = c(50,50),
err.fct = "sse",
linear.output = F,
threshold = 1,
lifesign = 'minimal',
rep = 1,
algorithm = 'rprop-',
stepmax = 10000)
Predict = compute(n, test_data)
nn2 <- ifelse(Predict$net.result[,1]>mean(Predict$net.result),1,0)
predictVstest <- cbind(test_data, Predict$net.result)
i <<- sum(predictVstest$ganhador == nn2)/ nrow(test_data)
print(i)
}
while ( i < 0.65) {
acharnn()
}
acharnn <- function(){
n <- neuralnet(ganhador == 1 ~ time1R + time2R + time1ACS + time2ACS + time1KAST + time2KAST + time1KD + time2KD +
time1ADR + time2ADR,
data = training_data,
hidden = c(60,60),
err.fct = "sse",
linear.output = F,
threshold = 2,
lifesign = 'minimal',
rep = 1,
algorithm = 'rprop-',
stepmax = 10000)
Predict = compute(n, test_data)
nn2 <- ifelse(Predict$net.result[,1]>mean(Predict$net.result),1,0)
predictVstest <- cbind(test_data, Predict$net.result)
i <<- sum(predictVstest$ganhador == nn2)/ nrow(test_data)
print(i)
}
while ( i < 0.65) {
acharnn()
}
acharnn <- function(){
n <- neuralnet(ganhador == 1 ~ time1R + time2R + time1ACS + time2ACS + time1KAST + time2KAST + time1KD + time2KD +
time1ADR + time2ADR,
data = training_data,
hidden = c(60,60),
err.fct = "sse",
linear.output = F,
threshold = 2,
lifesign = 'minimal',
rep = 1,
algorithm = 'rprop-',
stepmax = 100)
Predict = compute(n, test_data)
nn2 <- ifelse(Predict$net.result[,1]>mean(Predict$net.result),1,0)
predictVstest <- cbind(test_data, Predict$net.result)
i <<- sum(predictVstest$ganhador == nn2)/ nrow(test_data)
print(i)
}
while ( i < 0.647) {
acharnn()
}
acharnn <- function(){
n <- neuralnet(ganhador == 1 ~ time1R + time2R + time1ACS + time2ACS + time1KAST + time2KAST + time1KD + time2KD +
time1ADR + time2ADR,
data = training_data,
hidden = c(50,50),
err.fct = "sse",
linear.output = F,
threshold = 2,
lifesign = 'minimal',
rep = 1,
algorithm = 'rprop-',
stepmax = 100)
Predict = compute(n, test_data)
nn2 <- ifelse(Predict$net.result[,1]>mean(Predict$net.result),1,0)
predictVstest <- cbind(test_data, Predict$net.result)
i <<- sum(predictVstest$ganhador == nn2)/ nrow(test_data)
print(i)
}
while ( i < 0.647) {
acharnn()
}
ggplot(data = previsao, mapping = aes(x = previsao1, y = previsao2, colour = ganhador)) +
geom_tile(aes(fill = ganhador)) +
geom_point() +
theme_bw()
# Carregando pacotes --------------------------------------------------------------------------------------
library(rvest)
library(quantmod)
library(httr)
library(tibble)
library(stringr)
library(reshape2)
library(tidyverse)
library(neuralnet)
library(readr)
library(purrr)
load(file = "model_nnet.rda")
jogos <- read.csv2('csv/partidas.csv') %>% dplyr::select(-X, -ganhador)
outras_partidas <- read.csv2('csv/totalidade_jogos_sem_na.csv') %>% dplyr::select(-X, -ganhador)
jogos_scale <- rbind(jogos, outras_partidas)
jogos_scale <- scale(jogos_scale)
partidas <- jogos_scale[-1:-813,]
partidas <- as.data.frame(partidas)
previsao <- compute(n, partidas)
previsao <- previsao$net.result
partidas_reversas <- partidas
partidas_reversas$time1R <- partidas$time2R
partidas_reversas$time2R <- partidas$time1R
partidas_reversas$time1ACS <- partidas$time2ACS
partidas_reversas$time2ACS <- partidas$time1ACS
partidas_reversas$time1KAST <- partidas$time2KAST
partidas_reversas$time2KAST <- partidas$time1KAST
partidas_reversas$time1KD <- partidas$time2KD
partidas_reversas$time2KD <- partidas$time1KD
partidas_reversas$time1ADR <- partidas$time2ADR
partidas_reversas$time2ADR <- partidas$time1ADR
previsao2 <- compute(n, partidas_reversas)
previsao2 <- previsao2$net.result
previsoes <- cbind(previsao, previsao2)
transforma_positivo <- function (x){
y = atan(x*10) + pi/2
return (y)
}
transforma_probabilidade <- function (y, x){
z = y / (y + x)
w = x / (x + y)
c = as.matrix(c(z,w))
return(c)
}
a <- transforma_positivo(previsao)
b <- transforma_positivo(previsao2)
previsao <- transforma_probabilidade(a,b)
previsao <- previsao * 100
previsao2 <- previsao[(length(previsao)/2+1):length(previsao)]
previsao <- previsao[1:(length(previsao)/2)]
previsao <- cbind(previsao, previsao2)
ganhadores <- read.csv2('csv/totalidade_jogos_sem_na.csv') %>% dplyr::select(ganhador)
previsao <- cbind(previsao, ganhadores)
colnames(previsao) <- c('previsao1', 'previsao2', 'ganhador')
previsao <- previsao %>%
mutate(ganhador = as.factor(ganhador))
# Plot
ggplot(data = previsao, mapping = aes(x = previsao1, y = previsao2, colour = ganhador)) +
geom_tile(aes(fill = ganhador)) +
geom_point() +
theme_bw()
resultado_previsto <- ifelse(previsao$previsao1>previsao$previsao2, 1, 0)
resultadovspredict <- cbind(resultado_previsto, ganhadores)
i <- sum(resultadovspredict$ganhador == resultadovspredict$resultado_previsto)/nrow(resultadovspredict)
y <- round(i, 2)
View(resultadovspredict)
count(resultado_previsto)
length(resultado_previsto)
sum(resultado_previsto)
View(partidas)
resultadovspredict <- cbind(partidas, resultado_previsto, ganhadores)
i <- sum(resultadovspredict$ganhador == resultadovspredict$resultado_previsto)/nrow(resultadovspredict)
y <- round(i, 2)
# barchart with added parameters
barplot(resultadovspredict,
main = "Vitoria por R",
xlab = "Degree Celsius",
ylab = "Day",
names.arg = c("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"),
col = "darkred",
horiz = TRUE)
# barchart with added parameters
barplot(resultadovspredict,
main = "R",
xlab = "Degree Celsius",
ylab = "Day",
names.arg = c("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"),
col = "darkred",
horiz = TRUE)
?barplot
barplot(resultadovspredict,
main = "Survival of Each Class",
xlab = "Class",
col = c("red","green")
)
barplot(as.matrix(resultadovspredict),
main = "Survival of Each Class",
xlab = "Class",
col = c("red","green")
)
legend("topleft",
c("Not survived","Survived"),
fill = c("red","green")
)
?barplt
?barplot
barplot(as.matrix(resultadovspredict),
main = "Vitória por estatística",
xlab = "Estatística",
ylab = 'Vitórias'
col = c("red","green")
barplot(as.matrix(resultadovspredict),
main = "Vitória por estatística",
xlab = "Estatística",
ylab = 'Vitórias',
col = c("red","green")
)
legend("topleft",
c("Não ganhou","Ganhou"),
fill = c("red","green")
)
barplot(as.matrix(resultadovspredict),
main = "Vitória por estatística",
xlab = "Estatística",
ylab = 'Vitórias',
col = c("red","green",
formula = ganhador == 1 ~ time1R + time2R + time1ACS + time2ACS + time1KAST + time2KAST + time1KD + time2KD +
time1ADR + time2ADR)
)
legend("topleft",
c("Não ganhou","Ganhou"),
fill = c("red","green")
)
ggplot(resultadovspredict, aes(cut, fill=cut)) + geom_bar() + facet_grid(. ~ clarity)
ggplot(resultadovspredict, aes(cut, fill=cut)) + geom_bar() + facet_grid(. ~ R)
ggplot(resultadovspredict, aes(cut, fill=cut)) + geom_bar() + facet_grid(. ~ ganhador)
a
ggplot(data=resultadovspredict, aes(x=R)) +
geom_bar(aes(y = (..count..)/sum(..count..)))
ggplot(data=resultadovspredict, aes(x='R')) +
geom_bar(aes(y = (..count..)/sum(..count..)))
ggplot(data=resultadovspredict, aes(x='R')) +
geom_bar(aes(y = ganhador == 1))
ggplot(data=resultadovspredict, aes(x='R')) +
geom_bar(aes(y = 'ganhador' == 1))
ggplot(data=resultadovspredict, aes(x='R')) +
geom_bar(aes(y = ))
ggplot(data=resultadovspredict, aes(x='R')) +
geom_bar(aes(y = ganhadores))
ggplot(data=resultadovspredict, aes(x='R')) +
geom_bar(aes(y = ganhadores$ganhador))
ggplot(data=resultadovspredict, aes(x='R')) +
geom_bar(aes(y = 'ganhador'))
ggplot(data=resultadovspredict, aes(x='time1R')) +
geom_bar(aes(y = 'ganhador'))
ggplot(data=resultadovspredict, aes(x='time1R' > 'time2R')) +
geom_bar(aes(y = 'ganhador'))
ggplot(data=resultadovspredict, aes(x='time1R' > 'time2R')) +
geom_bar(aes(y = 'ganhador' == 1))
View(ganhadores)
acertos_erros <- ifelse(resultadovspredict$ganhador == resultadovspredict$resultado_previsto, 'Acertos', 'Erros')
acertos_erros <- ifelse(resultadovspredict$ganhador == '1' & '1' == resultadovspredict$resultado_previsto, 'Acerto_1', 'Erro_1')
?switch
acertos_erros <- c(resultadovspredict$resultado_previsto, resultadovspredict$ganhador)
acertos_erros <- paste(resultadovspredict$resultado_previsto, resultadovspredict$ganhador)
acertos_erros
ACS <- ifelse(resultadovspredict$time1ACS > resultadovspredict$time2ACS, 'ACS Maior', 'ACS Menor')
R <- ifelse(resultadovspredict$time1R > resultadovspredict$time2R, 'R1 Maior', 'R1 Menor')
R <- ifelse(resultadovspredict$time1R > resultadovspredict$time2R, 1, 0)
R <- ifelse(resultadovspredict$time1R > resultadovspredict$time2R, 1, 0)
ACS <- ifelse(resultadovspredict$time1ACS > resultadovspredict$time2ACS, 1, 0)
KAST <- ifelse(resultadovspredict$time1KAST > resultadovspredict$time2KAST, 1, 0)
KD <- ifelse(resultadovspredict$time1KD > resultadovspredict$time2KD, 1 , 0)
ADR <- ifelse(resultadovspredict$time1ADR > resultadovspredict$time2ADR, 1 , 0)
acertos_erros <- paste(resultadovspredict$resultado_previsto, resultadovspredict$ganhador)
grafico_data <- cbind(R, ACS, KAST, KD, ADR, acertos_erros)
grafico_data <- as.data.frame(c(R, ACS, KAST, KD, ADR, acertos_erros))
grafico_data <- as.data.frame(R, ACS, KAST, KD, ADR, acertos_erros)
grafico_data <- as.data.frame(cbind(R, ACS, KAST, KD, ADR, acertos_erros))
View(grafico_data)
ggplot(grafico_data, aes(R)) +
geom_bar(fill = "green") +
theme_pubclean()
ggplot(grafico_data, aes(R)) +
geom_bar(fill = "green")
?aes
ggplot(grafico_data, aes(x = R, y = acertos_erros)) +
geom_bar(fill = "green")
ggplot(grafico_data, aes(x = R)) +
geom_bar(fill = "green")
ggplot(grafico_data, aes(x = (R == 1 & acertos_erros == '1 1'))) +
geom_bar(fill = "green")
ggplot(grafico_data, aes(x = (R == 1 & acertos_erros == '1 1', R) )) +
ggplot(grafico_data, aes(x = (R == 1 & acertos_erros == '1 1'), R )) +
geom_bar(fill = "green")
ggplot(grafico_data, aes(x = (R == 1 & acertos_erros == '1 1'))) +
geom_bar(fill = "green")
library(plotly)
library(ggrepel)
library(ggrepel)
library(PerfomanceAnalytics)
install.packages(PerfomanceAnalytics)
install.packages('PerfomanceAnalytics')
