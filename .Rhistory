normalizando_training <- as.data.frame(scale(normalizando_training))
training_data <- dplyr::select(training_data, ganhador)
training_data <- cbind(normalizando_training, training_data)
training_data$ganhador <- as.factor(training_data$ganhador)
test_data$ganhador <- as.factor(test_data$ganhador)
load('model_nnet.rda')
Predict = compute(n, test_data)
nn2 <- ifelse(Predict$net.result[,1]>mean(Predict$net.result),1,0)
nn2 <- as.factor(nn2)
confusionMatrix(nn2, test_data$ganhador)
library(tibble)
library(stringr)
library(neuralnet)
library(caret)
# Carregando pacotes --------------------------------------------------------------------------------------
library(dplyr)
library(tidyr)
library(rvest)
library(quantmod)
library(httr)
confusionMatrix(nn2, test_data$ganhador)
library(ggplot2)
x <- confusionMatrix(nn2, test_data$ganhador)
View(x)
df <- x$table
x$positive
x$overall
x$byClass
x$mode
x <- x$table
x
x <- x$table
x <- confusionMatrix(nn2, test_data$ganhador)
x <- x$table
view(x)
ggplot(data = x, mapping = aes(x = Reference, y = Prediction)) +
geom_tile(aes(fill = Y), colour = 'white') +
geom_text(aes(label = sprintf('%1.0f', Y)), vjust = 1) +
scale_fill_gradient(low = 'blue', high = 'red') +
theme_bw() + theme(legend.position = 'none')
x <- confusionMatrix(nn2, test_data$ganhador)
x <- as.data.frame(x$table)
ggplot(data = x, mapping = aes(x = Reference, y = Prediction)) +
geom_tile(aes(fill = Y), colour = 'white') +
geom_text(aes(label = sprintf('%1.0f', Y)), vjust = 1) +
scale_fill_gradient(low = 'blue', high = 'red') +
theme_bw() + theme(legend.position = 'none')
View(x)
View(x)
ggplot(data = x, mapping = aes(x = Reference, y = Prediction)) +
geom_tile(aes(fill = FREQ), colour = 'white') +
geom_text(aes(label = sprintf('%1.0f', FREQ)), vjust = 1) +
scale_fill_gradient(low = 'blue', high = 'red') +
theme_bw() + theme(legend.position = 'none')
ggplot(data = x, mapping = aes(x = Reference, y = Prediction)) +
geom_tile(aes(fill = Freq), colour = 'white') +
geom_text(aes(label = sprintf('%1.0f', Freq)), vjust = 1) +
scale_fill_gradient(low = 'blue', high = 'red') +
theme_bw() + theme(legend.position = 'none')
ggplot(data = x, mapping = aes(x = Reference, y = Prediction)) +
geom_tile(aes(fill = Freq), colour = 'white') +
geom_text(aes(label = sprintf('%1.0f', Freq)), vjust = 1) +
scale_fill_gradient(low = 'blue', high = 'green') +
theme_bw() + theme(legend.position = 'none')
ggplot(data = x, mapping = aes(x = Reference, y = Prediction)) +
geom_tile(aes(fill = Freq), colour = 'white') +
geom_text(aes(label = sprintf('%1.0f', Freq)), vjust = 1) +
scale_fill_gradient(low = 'red', high = 'green') +
theme_bw() + theme(legend.position = 'none')
ggplot(data = x, mapping = aes(x = Reference, y = Prediction)) +
geom_tile(aes(fill = Freq), colour = 'blue') +
geom_text(aes(label = sprintf('%1.0f', Freq)), vjust = 1) +
scale_fill_gradient(low = 'red', high = 'green') +
theme_bw() + theme(legend.position = 'none')
ggplot(data = x, mapping = aes(x = Reference, y = Prediction)) +
geom_tile(aes(fill = Freq), colour = 'white') +
geom_text(aes(label = sprintf('%1.0f', Freq)), vjust = 1) +
scale_fill_gradient(low = 'red', high = 'green') +
theme_bw() + theme(legend.position = 'none')
?scale_fill_gradient
ggplot(data = x, mapping = aes(x = Reference, y = Prediction)) +
geom_tile(aes(fill = Freq), colour = 'white') +
geom_text(aes(label = sprintf('%1.0f', Freq)), vjust = 1) +
scale_fill_gradient(low = 'black', high = 'green') +
theme_bw() + theme(legend.position = 'none')
ggplot(data = x, mapping = aes(x = Reference, y = Prediction)) +
geom_tile(aes(fill = Freq), colour = 'white') +
geom_text(aes(label = sprintf('%1.0f', Freq)), vjust = 1) +
scale_fill_gradient(low = 'white', high = 'green') +
theme_bw() + theme(legend.position = 'none')
load('model_nnet.rda')
# Carregando pacotes --------------------------------------------------------------------------------------
library(dplyr)
library(tidyr)
library(rvest)
library(quantmod)
library(httr)
library(tibble)
library(stringr)
library(neuralnet)
library(caret)
library(ggplot2)
plot(n)
# Carregando pacotes --------------------------------------------------------------------------------------
library(dplyr)
library(tidyr)
library(rvest)
library(quantmod)
library(httr)
library(tibble)
library(stringr)
library(neuralnet)
library(caret)
library(ggplot2)
?neuralnet
?scale
# Carregando pacotes --------------------------------------------------------------------------------------
library(rvest)
library(quantmod)
library(httr)
library(tibble)
library(stringr)
library(reshape2)
library(tidyverse)
library(neuralnet)
library(readr)
library(purrr)
historico <- read.csv2('csv/historico_formatado.csv') %>% dplyr::select(-X)
teste <- array(historico, dim = c(10, 10, 11767))
View(teste)
teste[1]
?array
teste <- array(data = historico, dim = c(10, 10, 10))
View(teste)
teste <- array(data = historico, dim = c(10, 10))
View(teste)
View(teste)
View(teste)
View(teste)
teste[1]
?dim
dados_gerais <- read.csv2('csv/jogadores.csv')
# Arrumando as colunas -------------------------------------------------------------------------------------
dados_gerais <- dplyr::select(dados_gerais, Player, R, ACS, K.D, KAST, ADR)
row.names(dados_gerais) <- make.names(dados_gerais[,1], unique = T)
dados_gerais <- dplyr::select(dados_gerais, -Player)
dados_gerais$KAST <- parse_number(dados_gerais$KAST)
jogos <- read.csv2('csv/partidas.csv') %>% dplyr::select(-X, -ganhador)
outras_partidas <- read.csv2('csv/outras_partidas.csv') %>% dplyr::select(-X, -ganhador)
jogos_scale <- rbind(jogos, outras_partidas)
jogos_scale <- scale(jogos_scale)
partidas <- jogos_scale[-1:-813,]
partidas <- as.data.frame(partidas)
previsao <- compute(n, partidas)
previsao <- previsao$net.result
# Carregando pacotes --------------------------------------------------------------------------------------
library(rvest)
library(quantmod)
library(httr)
library(tibble)
library(stringr)
library(reshape2)
library(tidyverse)
library(neuralnet)
library(readr)
library(purrr)
dados_gerais <- read.csv2('csv/jogadores.csv')
# Arrumando as colunas -------------------------------------------------------------------------------------
dados_gerais <- dplyr::select(dados_gerais, Player, R, ACS, K.D, KAST, ADR)
row.names(dados_gerais) <- make.names(dados_gerais[,1], unique = T)
dados_gerais <- dplyr::select(dados_gerais, -Player)
dados_gerais$KAST <- parse_number(dados_gerais$KAST)
jogos <- read.csv2('csv/partidas.csv') %>% dplyr::select(-X, -ganhador)
outras_partidas <- read.csv2('csv/outras_partidas.csv') %>% dplyr::select(-X, -ganhador)
jogos_scale <- rbind(jogos, outras_partidas)
jogos_scale <- scale(jogos_scale)
partidas <- jogos_scale[-1:-813,]
partidas <- as.data.frame(partidas)
previsao <- compute(n, partidas)
previsao <- previsao$net.result
partidas_reversas <- partidas
partidas_reversas$time1R <- partidas$time2R
partidas_reversas$time2R <- partidas$time1R
partidas_reversas$time1ACS <- partidas$time2ACS
partidas_reversas$time2ACS <- partidas$time1ACS
partidas_reversas$time1KAST <- partidas$time2KAST
load(file = "model_nnet.rda")
dados_gerais <- read.csv2('csv/jogadores.csv')
# Arrumando as colunas -------------------------------------------------------------------------------------
dados_gerais <- dplyr::select(dados_gerais, Player, R, ACS, K.D, KAST, ADR)
row.names(dados_gerais) <- make.names(dados_gerais[,1], unique = T)
dados_gerais <- dplyr::select(dados_gerais, -Player)
dados_gerais$KAST <- parse_number(dados_gerais$KAST)
jogos <- read.csv2('csv/partidas.csv') %>% dplyr::select(-X, -ganhador)
outras_partidas <- read.csv2('csv/outras_partidas.csv') %>% dplyr::select(-X, -ganhador)
jogos_scale <- rbind(jogos, outras_partidas)
jogos_scale <- scale(jogos_scale)
partidas <- jogos_scale[-1:-813,]
partidas <- as.data.frame(partidas)
previsao <- compute(n, partidas)
previsao <- previsao$net.result
partidas_reversas <- partidas
partidas_reversas$time1R <- partidas$time2R
partidas_reversas$time2R <- partidas$time1R
partidas_reversas$time1ACS <- partidas$time2ACS
partidas_reversas$time2ACS <- partidas$time1ACS
partidas_reversas$time1KAST <- partidas$time2KAST
partidas_reversas$time2KAST <- partidas$time1KAST
partidas_reversas$time1KD <- partidas$time2KD
partidas_reversas$time2KD <- partidas$time1KD
partidas_reversas$time1ADR <- partidas$time2ADR
partidas_reversas$time2ADR <- partidas$time1ADR
previsao2 <- compute(n, partidas_reversas)
previsao2 <- previsao2$net.result
previsoes <- cbind(previsao, previsao2)
transforma_positivo <- function (x){
y = atan(x*10) + pi/2
return (y)
}
transforma_probabilidade <- function (y, x){
z = y / (y + x)
w = x / (x + y)
c = as.matrix(c(z,w))
return(c)
}
a <- transforma_positivo(previsao)
b <- transforma_positivo(previsao2)
previsao <- transforma_probabilidade(a,b)
previsao <- previsao * 100
previsao2 <- previsao[278:554]
previsao <- previsao[1:277]
previsao <- cbind(previsao, previsao2)
ganhadores <- read.csv2('csv/outras_partidas.csv') %>% dplyr::select(ganhador)
previsao <- cbind(previsao, ganhadores)
colnames(previsao) <- c('previsao1', 'previsao2', 'ganhador')
previsao <- previsao %>%
mutate(ganhador = as.factor(ganhador))
# Plot
ggplot(data = previsao, mapping = aes(x = previsao1, y = previsao2, colour = ganhador)) +
geom_tile(aes(fill = ganhador)) +
geom_point() +
theme_bw()
View(previsao)
previsao <- transforma_probabilidade(a,b)
previsao <- previsao * 100
previsao2 <- previsao[278:554]
previsao <- previsao[1:277]
previsao <- cbind(previsao, previsao2)
ganhadores <- read.csv2('csv/outras_partidas.csv') %>% dplyr::select(ganhador)
previsao <- cbind(previsao, ganhadores)
colnames(previsao) <- c('previsao1', 'previsao2', 'ganhador')
previsao <- previsao %>%
mutate(ganhador = as.factor(ganhador))
# Plot
ggplot(data = previsao, mapping = aes(x = previsao1, y = previsao2, colour = ganhador)) +
geom_tile(aes(fill = ganhador)) +
geom_point() +
theme_bw()
historico <- read.csv2('csv/historico_formatado.csv') %>% dplyr::select(-X)
# Carregando pacotes --------------------------------------------------------------------------------------
library(rvest)
library(quantmod)
library(httr)
library(tibble)
library(stringr)
library(reshape2)
library(tidyverse)
library(neuralnet)
library(readr)
library(purrr)
historico <- read.csv2('csv/historico_formatado.csv') %>% dplyr::select(-X)
teste <- array(unlist(historico), c(10, 10, 2),
dimnames=list(rownames(df1), colnames(df1)))
teste <- array(unlist(historico), c(10, 10, 2),
dimnames=list(rownames(historico), colnames(historico)))
teste <- array(unlist(historico), c(10, 10, 2))
teste[1]
teste[2]
teste <- array(unlist(historico), c(10, 10))
teste <- array(unlist(historico), c(100, 10))
teste <- array(unlist(historico), c(100, 100))
teste <- array(unlist(historico), c(100, 100, 100))
teste[1]
teste[[1]]
mat <- as.matrix(historico)
View(mat)
mat[]
mat[1]
mat[1,2]
?as.matrix
mat <- as.matrix(historico, nrow = 10, ncol = 10) #testando
mat[1]
mat <- as.matrix(historico, nrow = 10, ncol = 10, byrow = TRUE) #testando
mat[1]
mat <- as.matrix(historico) #testando
mat <- as.matrix.data.frame(historico) #testando
mat[1]
?as.matrix.data.frame
data = split(historico, seq(nrow(historico)))
?seq
data = split(historico, seq(nrow(historico), by = 10))
data = split(historico, seq(1, nrow(historico), by = 10))
View(data)
data[1]
data[1[1]]
player[1,[1]]
player[1][1]
data[1][1]
data[1[1]]
data[1]$1
data[1$Player]
data$1
write.csv(data, 'teste')
data = split(historico, seq(0, nrow(historico), by = 10))
data = split(historico, seq(1, nrow(historico), by = 11))
?split
data = split(historico, seq(1, nrow(historico), by = 11), lex.order = T)
data = split(historico, seq(1, ncol(historico), by = 11))
View(data)
data = split(historico, seq(1, 10, by = 1))
data = split(historico, seq(historico, by = 1))
data = split(historico, seq(nrow(historico), by = 1))
data = split(historico, seq(nrow(historico)))
View(data)
?for
?for each
?foreach
?for
?for()
i <- 1
n <- 1
data <- list()
split(historico, 1, 10)
split(historico, seq(1, 10))
historico[1:10]
historico[1:10,]
m <- 10
while(i < 11767){
data[[length(data)+1]] <- historico[n: m,]
n = n + 10
m = m + 10
i = i + 1
}
View(data)
data[1]
data[2]
data[3]
data[4]
data[11765]
rm(mat)
rm(teste)
rm(data)
while(i < 11767){
partidas[[length(partidas)+1]] <- historico[n: m,]
n = n + 10
m = m + 10
i = i + 1
}
i <- 1
n <- 1
m <- 10
i <- 1
n <- 1
m <- 10
partidas <- list()
while(i < 11767){
partidas[[length(partidas)+1]] <- historico[n: m,]
n = n + 10
m = m + 10
i = i + 1
}
partidas[11766]
View(historico)
i <- 1
n <- 1
m <- 10
partidas <- list()
while(i = 11767){
while(i == 11767){
partidas[[length(partidas)+1]] <- historico[n: m,]
n = n + 10
m = m + 10
i = i + 1
}
while(i == 11767){
partidas[[length(partidas)+1]] <- historico[n: m,]
n = n + 10
m = m + 10
i = i + 1
}
while(i === 11767){
while(i < 11768){
partidas[[length(partidas)+1]] <- historico[n: m,]
n = n + 10
m = m + 10
i = i + 1
}
partidas[11768]
partidas[11767]
View(partidas)
View(historico)
i <- 1
n <- 1
m <- 10
partidas <- list()
while(i < 11767){
partidas[[length(partidas)+1]] <- historico[n: m,]
n = n + 10
m = m + 10
i = i + 1
}
partidas[11767]
partidas[11766]
i <- 1
n <- 1
m <- 10
partidas <- list()
while(i < 11768){
partidas[[length(partidas)+1]] <- historico[n: m,]
n = n + 10
m = m + 10
i = i + 1
}
partidas[11767]
View(historico)
write.csv2(historico, 'csv/historico.csv')
historico <- read.csv2('csv/historico.csv') %>% dplyr::select(-X)
i <- 1
n <- 1
m <- 10
partidas <- list()
while(i < 11768){
partidas[[length(partidas)+1]] <- historico[n: m,]
n = n + 10
m = m + 10
i = i + 1
}
# Carregando pacotes --------------------------------------------------------------------------------------
library(rvest)
library(quantmod)
library(httr)
library(tibble)
library(stringr)
library(reshape2)
library(tidyverse)
library(neuralnet)
library(readr)
library(purrr)
historico <- read.csv2('csv/historico.csv') %>% dplyr::select(-X)
i <- 1
n <- 1
m <- 10
partidas <- list()
while(i < 11768){
partidas[[length(partidas)+1]] <- historico[n: m,]
n = n + 10
m = m + 10
i = i + 1
}
rm(historico)
rm(historico, i, m, n)
partidas[5]
partidas$Player
partida[,Player]
partidas[,Player]
partidas[,1]
partidas[is.element(partidas$Player, 'aspas'),]
partidas[is.element(partidas$Player, 'aspas'),,]
partidas[is.element(partidas$Player, 'aspas')]
partidas[partidas$Player %in% 'aspas',]
partidas[partidas$Player %in% 'aspas']
summarize(partidas)
partidas[[1]][[1]]
partidas[[1]]
partidas[[]][[]]
partidas[[]][[1]]
partidas[[,]][[1]]
partidas[[i]][[1]]
View(partidas)
historico <- read.csv2('csv/historico.csv') %>% dplyr::select(-X)
i <- 1
n <- 1
m <- 10
partidas <- list()
length(historico)
count(historico)
count(historico) / 10
(count(historico) / 10) + 1
while(i < (count(historico) / 10) + 1){
partidas[[length(partidas)+1]] <- historico[n: m,]
n = n + 10
m = m + 10
i = i + 1
}
View(partidas)
partidas[11767]
View(historico)
partidas[1][1]
partidas[1][[1]
]
partidas[[1]][[1]]
partidas[[1]][[1]] == snikk
partidas[[1]][[1]] == 'snikk'
select(partidas[[1]][[1]] == 'snikk')
partidas[[1]]$Player == 'snikk'
partidas[[1]]$Player
filter(partidas[[1]]$Player == 'xuss')
filter(partidas, partidas[[1]]$Player == 'xuss')
partidas[partidas[[1]]$Player == 'snikk']
testando <- partidas[partidas[[1]]$Player == 'snikk']
View(testando)
testando[1176]
