m = m + 1
}, error = function(e){cat('error:', conditionMessage(e), '\n')})
}
a[1547]
View(dff)
dff[1547]
# Carregando pacotes --------------------------------------------------------------------------------------
library(rvest)
library(quantmod)
library(httr)
library(tibble)
library(stringr)
library(reshape2)
library(tidyverse)
library(neuralnet)
library(readr)
library(purrr)
for (i in a){
tryCatch({
dff[[length(dff)+1]] <- catalogarporUrl(a[m])
m = m + 1
}, error = function(e){cat('error:', conditionMessage(e), '\n')})
}
# Carregando pacotes --------------------------------------------------------------------------------------
library(rvest)
library(quantmod)
library(httr)
library(tibble)
library(stringr)
library(reshape2)
library(tidyverse)
library(neuralnet)
library(readr)
library(purrr)
for (i in a){
tryCatch({
dff[[length(dff)+1]] <- catalogarporUrl(a[m])
m = m + 1
}, error = function(e){cat('error:', conditionMessage(e), '\n')})
}
# Carregando pacotes --------------------------------------------------------------------------------------
library(rvest)
library(quantmod)
library(httr)
library(tibble)
library(stringr)
library(reshape2)
library(tidyverse)
library(neuralnet)
library(readr)
library(purrr)
for (i in a){
tryCatch({
dff[[length(dff)+1]] <- catalogarporUrl(a[m])
m = m + 1
}, error = function(e){cat('error:', conditionMessage(e), '\n')})
}
write.csv2('csv/historico.csv')
write.csv2(dff, 'csv/historico.csv')
View(dff)
dff <- dff %>% map_df(as_tibble)
dff <- na.omit(dff)
write.csv2(dff, 'csv/historico_formatado.csv')
write.csv(dff, 'csv/historico_formatado.csv')
write.csv(dff, 'csv/historico_formatado.csv')
write.csv2(dff, 'csv/historico_formatado.csv')
write.csv2(dff, 'csv/historico_formatado.csv')
keenc <- dff$Player=='keenc'
rm(keenc)
keenc <- select(dff$Player=='keenc')
keenc <- dff[dff$Player == 'keenc',]
View(keenc)
mean(keenc$R)
mean(as.numeric(keenc$R))
mean(as.numeric(keenc$ACS))
mean(as.numeric(keenc$K:d))
mean(as.numeric(keenc$K:D))
mean(as.numeric(keenc$kast))
mean(as.numeric(keenc$KAST))
mean(as.numeric(keenc$ADR))
rm(keenc)
player_name <- 'aspas'
player_name <- select(dff[dff$Player == player_name,])
View(player_name)
player_name <- 'aspas'
player_name <- dff[dff$Player == player_name,]
View(player_name)
player <- 'aspas'
player <- dff[dff$Player == player,]
rm(player_name)
View(player)
mean(as.numeric(player$R))
# Carregando pacotes --------------------------------------------------------------------------------------
library(rvest)
library(quantmod)
library(httr)
library(tibble)
library(stringr)
library(reshape2)
library(tidyverse)
library(neuralnet)
library(readr)
library(purrr)
# Carregando pacotes --------------------------------------------------------------------------------------
library(rvest)
library(quantmod)
library(httr)
library(tibble)
library(stringr)
library(reshape2)
library(tidyverse)
library(neuralnet)
library(readr)
library(purrr)
View(dados_gerais)
dados_gerais <- dplyr::select(dados_gerais, Player, R, ACS, K.D, KAST, ADR)
row.names(dados_gerais) <- make.names(dados_gerais[,1], unique = T)
dados_gerais <- dplyr::select(dados_gerais, -Player)
dados_gerais$KAST <- parse_number(dados_gerais$KAST)
info <- read_html(string) %>%
html_nodes("table") %>%
html_table()
ganhador <- 1
timeA <- c('xAims', 'TASP', 'cchrisM', 'Bisu', 'RaveN')
timeA <- paste0('\\b', timeA, '\\b')
dados_gerais$timeA <- ifelse(grepl(paste(timeA, collapse = '|'), rownames(dados_gerais), useBytes = T), 1, 0)
timeB <- c('enerii', 'conir', 'Kohaibi', 'WISPERIOUS', 'keenc')
timeB <- paste0('\\b', timeB, '\\b')
dados_gerais$timeB <- ifelse(grepl(paste(timeB, collapse = '|'), rownames(dados_gerais), useBytes = T), 1, 0)
timeA_df <- filter(dados_gerais, dados_gerais$timeA == 1)
timeA_df <- dplyr::select(timeA_df, R, ACS, K.D, KAST, ADR)
timeB_df <- filter(dados_gerais, dados_gerais$timeB == 1)
timeB_df <- dplyr::select(timeB_df, R, ACS, K.D, KAST, ADR)
if(nrow(timeA_df) == 5 && nrow(timeB_df) == 5){
# Médias
timeA_R <- mean(timeA_df$R)
timeA_ACS <- mean(timeA_df$ACS)
timeA_KAST <- mean(timeA_df$KAST)
timeA_KD <- mean(timeA_df$K.D)
timeA_ADR <- mean(timeA_df$ADR)
timeB_R <- mean(timeB_df$R)
timeB_ACS <- mean(timeB_df$ACS)
timeB_KAST <- mean(timeB_df$KAST)
timeB_KD <- mean(timeB_df$K.D)
timeB_ADR <- mean(timeB_df$ADR)
partida <- c(timeA_R, timeB_R, timeA_ACS, timeB_ACS, timeA_KAST, timeB_KAST, timeA_KD, timeB_KD,
timeA_ADR, timeB_ADR)
partida <- t(partida)
partida <- as.data.frame(partida) %>% cbind(ganhador)
colnames(partida) <- c('time1R', 'time2R', 'time1ACS', 'time2ACS', 'time1KAST', 'time2KAST', 'time1KD', 'time2KD',
'time1ADR', 'time2ADR', 'ganhador')
return(partida)
}
# Médias
timeA_R <- mean(timeA_df$R)
timeA_ACS <- mean(timeA_df$ACS)
timeA_KAST <- mean(timeA_df$KAST)
timeA_KD <- mean(timeA_df$K.D)
timeA_ADR <- mean(timeA_df$ADR)
timeB_R <- mean(timeB_df$R)
timeB_ACS <- mean(timeB_df$ACS)
timeB_KAST <- mean(timeB_df$KAST)
timeB_KD <- mean(timeB_df$K.D)
timeB_ADR <- mean(timeB_df$ADR)
partida <- c(timeA_R, timeB_R, timeA_ACS, timeB_ACS, timeA_KAST, timeB_KAST, timeA_KD, timeB_KD,
timeA_ADR, timeB_ADR)
partida <- t(partida)
partida <- as.data.frame(partida) %>% cbind(ganhador)
View(partida)
partida <- dplyr::select(partida, -ganhador)
colnames(partida) <- c('time1R', 'time2R', 'time1ACS', 'time2ACS', 'time1KAST', 'time2KAST', 'time1KD', 'time2KD',
'time1ADR', 'time2ADR', 'ganhador')
View(partida)
colnames(partida) <- c('time1R', 'time2R', 'time1ACS', 'time2ACS', 'time1KAST', 'time2KAST', 'time1KD', 'time2KD',
'time1ADR', 'time2ADR')
load(file = "model_nnet.rda")
View(partida)
jogos_scale <- read.csv2('csv/df.csv') %>% dplyr::select(-X, -ganhador)
jogos <- read.csv2('csv/outras_partidas.csv') %>% dplyr::select(-X, -ganhador)
jogos_scale <- rbind(jogos, partida)
View(jogos_scale)
jogos_scale <- scale(jogos_scale)
jogos <- read.csv2('csv/partidas.csv') %>% dplyr::select(-X, -ganhador)
jogos_scale <- rbind(jogos, partida)
jogos_scale <- scale(jogos_scale)
partidas <- jogos_scale[-1:-813,]
partidas <- as.data.frame(partidas)
View(partidas)
partidas <- t(partidas)
previsao <- compute(n, partidas)
previsao <- previsao$net.result
View(previsao)
previsao$net.result
previsao <- compute(n, partidas)
previsao <- previsao$net.result
partidas_reversas <- partidas
partidas_reversas$time1R <- partidas$time2R
partidas_reversas$time2R <- partidas$time1R
partidas_reversas$time1ACS <- partidas$time2ACS
partidas_reversas$time2ACS <- partidas$time1ACS
partidas_reversas$time1KAST <- partidas$time2KAST
partidas_reversas$time2KAST <- partidas$time1KAST
partidas_reversas$time1KD <- partidas$time2KD
partidas_reversas$time2KD <- partidas$time1KD
partidas_reversas$time1ADR <- partidas$time2ADR
partidas_reversas$time2ADR <- partidas$time1ADR
previsao2 <- compute(n, partidas_reversas)
previsao2 <- previsao2$net.result
previsoes <- ifelse (previsao[,1] > previsao2[,1], 1, 0)
a <- previsao
b <- previsao2
transforma_positivo <- function (x){
y = atan(x) + pi/2
return (y)
}
transforma_probabilidade <- function (y, x){
z = y / (y + x)
w = x / (x + y)
c = as.matrix(c(z,w))
return(c)
}
a <- transforma_positivo(a)
b <- transforma_positivo(b)
previsao <- transforma_probabilidade(a,b)
previsao <- previsao * 100
link <- "https://www.vlr.gg/stats/?event_group_id=all&event_id=all&region=all&country=all&min_rounds=50&min_rating=1550&agent=all&map_id=all&timespan=all"
players <- read_html(link) %>%
html_node("table") %>%
html_table() %>%
separate(Player, into = c("Player", "Team"), sep = "\\s+", extra = "merge") %>%
select('Player', 'Team', 'R', 'ACS', 'K:D', 'KAST', 'ADR') %>%
as.data.frame()
# Carregando pacotes
library(shiny)
library(shinythemes)
library(dplyr)
library(tidyr)
library(rvest)
library(quantmod)
library(httr)
library(tibble)
library(stringr)
library(neuralnet)
library(reshape2)
library(data.table)
library(readr)
library(ggplot2)
library(DT)
load(file = "model_nnet.rda")
players <- read_html(link) %>%
html_node("table") %>%
html_table() %>%
separate(Player, into = c("Player", "Team"), sep = "\\s+", extra = "merge") %>%
select('Player', 'Team', 'R', 'ACS', 'K:D', 'KAST', 'ADR') %>%
as.data.frame()
View(players)
# Arrumando as colunas -------------------------------------------------------------------------------------
players <- dplyr::select(players, Player, R, ACS, 'K:D', KAST, ADR)
row.names(players) <- make.names(players[,1], unique = T)
players <- dplyr::select(players, -Player)
players$KAST <- parse_number(players$KAST)
View(players)
# Time A
timeA = c('aspas', 'Sacy', 'Sadhaak', 'pAncada', 'Less')
timeA <- paste0('\\b', timeA, '\\b')
players$timeA <- ifelse(grepl(paste(timeA, collapse = '|'), rownames(players), useBytes = T), 1, 0)
# Time B
timeB = c('FNS', 'yay', 'crashies', 'Marved', 'Victor')
timeB <- paste0('\\b', timeB, '\\b')
players$timeB <- ifelse(grepl(paste(timeB, collapse = '|'), rownames(players), useBytes = T), 1, 0)
timeA_df <- filter(players, players$timeA == 1)
timeA_df <- dplyr::select(timeA_df, R, ACS, 'K:D', KAST, ADR)
timeB_df <- filter(players, players$timeB == 1)
timeB_df <- dplyr::select(timeB_df, R, ACS, 'K:D', KAST, ADR)
View(timeA_df)
View(timeB_df)
# Time A
timeA = c('aspas', 'Sacy', 'saadhak', 'pANcada', 'Less')
timeA <- paste0('\\b', timeA, '\\b')
players$timeA <- ifelse(grepl(paste(timeA, collapse = '|'), rownames(players), useBytes = T), 1, 0)
# Time B
timeB = c('FNS', 'yay', 'crashies', 'Marved', 'Victor')
timeB <- paste0('\\b', timeB, '\\b')
players$timeB <- ifelse(grepl(paste(timeB, collapse = '|'), rownames(players), useBytes = T), 1, 0)
timeA_df <- filter(players, players$timeA == 1)
timeA_df <- dplyr::select(timeA_df, R, ACS, 'K:D', KAST, ADR)
timeB_df <- filter(players, players$timeB == 1)
timeB_df <- dplyr::select(timeB_df, R, ACS, 'K:D', KAST, ADR)
# Médias
timeA_R <- mean(timeA_df$R)
timeA_ACS <- mean(timeA_df$ACS)
timeA_KAST <- mean(timeA_df$KAST)
timeA_KD <- mean(timeA_df$'K:D')
timeA_ADR <- mean(timeA_df$ADR)
timeB_R <- mean(timeB_df$R)
timeB_ACS <- mean(timeB_df$ACS)
timeB_KAST <- mean(timeB_df$KAST)
timeB_KD <- mean(timeB_df$'K:D')
timeB_ADR <- mean(timeB_df$ADR)
partida <- c(timeA_R, timeB_R, timeA_ACS, timeB_ACS, timeA_KAST, timeB_KAST, timeA_KD, timeB_KD,
timeA_ADR, timeB_ADR)
jogos_scale <- read.csv2('csv/partidas.csv') %>% select(-X, -ganhador)
jogos_scale <- rbind(jogos_scale, partida)
jogos_scale <- scale(jogos_scale)
partida <- jogos_scale[814,]
partida <- t(partida)
partida <- as.data.frame(partida)
colnames(partida) <- c('time1R', 'time2R', 'time1ACS', 'time2ACS', 'time1KAST', 'time2KAST', 'time1KD', 'time2KD',
'time1ADR', 'time2ADR')
View(partida)
previsao <- compute(n, partida)
previsao <- previsao$net.result[1]
partida_reversa <- partida
partida_reversa$time1R <- partida$time2R
partida_reversa$time2R <- partida$time1R
partida_reversa$time1ACS <- partida$time2ACS
partida_reversa$time2ACS <- partida$time1ACS
partida_reversa$time1KAST <- partida$time2KAST
partida_reversa$time2KAST <- partida$time1KAST
partida_reversa$time1KD <- partida$time2KD
partida_reversa$time2KD <- partida$time1KD
partida_reversa$time1ADR <- partida$time2ADR
partida_reversa$time2ADR <- partida$time1ADR
previsao2 <- compute(n, partida_reversa)
previsao2 <- previsao2$net.result[1]
a <- previsao
b <- previsao2
transforma_positivo <- function (x){
y = atan(x) + pi/2
return (y)
}
transforma_probabilidade <- function (y, x){
z = y / (y + x)
w = x / (x + y)
c = as.matrix(c(z,w))
return(c)
}
a <- transforma_positivo(a)
b <- transforma_positivo(b)
previsao <- transforma_probabilidade(a,b)
previsao <- previsao * 100
read.csv2('csv/historico_formatado.csv')
historico <- read.csv2('csv/historico_formatado.csv')
View(historico)
rm(historico)
link <- "https://www.vlr.gg/stats/?event_group_id=all&event_id=all&region=all&country=all&min_rounds=50&min_rating=1550&agent=all&map_id=all&timespan=all"
players <- read_html(link) %>%
html_node("table") %>%
html_table() %>%
separate(Player, into = c("Player", "Team"), sep = "\\s+", extra = "merge") %>%
select('Player', 'Team', 'R', 'ACS', 'K:D', 'KAST', 'ADR') %>%
as.data.frame()
View(players)
players <- read_html(link) %>%
html_node("table") %>%
html_table() %>%
separate(Player, into = c("Player", "Team"), sep = "\\s+", extra = "merge") %>%
select('Player', 'Team', 'R', 'Rnd', 'ACS', 'K:D', 'KAST', 'ADR') %>%
as.data.frame()
View(players)
# Matriz de confusão ---------------------------------------------------------------------------------------
jogos <- read.csv2('csv/partidas.csv') %>% dplyr::select(-X)
set.seed(3)
inp <- sample(2, nrow(jogos), replace = TRUE, prob = c(0.7, 0.3))
training_data <- jogos[inp==1, ]
test_data <- jogos[inp==2, ]
normalizando_test <- dplyr::select(test_data, -ganhador)
normalizando_test <- as.data.frame(scale(normalizando_test))
test_data <- dplyr::select(test_data, ganhador)
test_data <- cbind(normalizando_test, test_data)
normalizando_training <- dplyr::select(training_data, -ganhador)
normalizando_training <- as.data.frame(scale(normalizando_training))
training_data <- dplyr::select(training_data, ganhador)
training_data <- cbind(normalizando_training, training_data)
training_data$ganhador <- as.factor(training_data$ganhador)
test_data$ganhador <- as.factor(test_data$ganhador)
load('model_nnet.rda')
Predict = compute(n, test_data)
nn2 <- ifelse(Predict$net.result[,1]>mean(Predict$net.result),1,0)
nn2 <- as.factor(nn2)
confusionMatrix(nn2, test_data$ganhador)
library(tibble)
library(stringr)
library(neuralnet)
library(caret)
# Carregando pacotes --------------------------------------------------------------------------------------
library(dplyr)
library(tidyr)
library(rvest)
library(quantmod)
library(httr)
confusionMatrix(nn2, test_data$ganhador)
library(ggplot2)
x <- confusionMatrix(nn2, test_data$ganhador)
View(x)
df <- x$table
x$positive
x$overall
x$byClass
x$mode
x <- x$table
x
x <- x$table
x <- confusionMatrix(nn2, test_data$ganhador)
x <- x$table
view(x)
ggplot(data = x, mapping = aes(x = Reference, y = Prediction)) +
geom_tile(aes(fill = Y), colour = 'white') +
geom_text(aes(label = sprintf('%1.0f', Y)), vjust = 1) +
scale_fill_gradient(low = 'blue', high = 'red') +
theme_bw() + theme(legend.position = 'none')
x <- confusionMatrix(nn2, test_data$ganhador)
x <- as.data.frame(x$table)
ggplot(data = x, mapping = aes(x = Reference, y = Prediction)) +
geom_tile(aes(fill = Y), colour = 'white') +
geom_text(aes(label = sprintf('%1.0f', Y)), vjust = 1) +
scale_fill_gradient(low = 'blue', high = 'red') +
theme_bw() + theme(legend.position = 'none')
View(x)
View(x)
ggplot(data = x, mapping = aes(x = Reference, y = Prediction)) +
geom_tile(aes(fill = FREQ), colour = 'white') +
geom_text(aes(label = sprintf('%1.0f', FREQ)), vjust = 1) +
scale_fill_gradient(low = 'blue', high = 'red') +
theme_bw() + theme(legend.position = 'none')
ggplot(data = x, mapping = aes(x = Reference, y = Prediction)) +
geom_tile(aes(fill = Freq), colour = 'white') +
geom_text(aes(label = sprintf('%1.0f', Freq)), vjust = 1) +
scale_fill_gradient(low = 'blue', high = 'red') +
theme_bw() + theme(legend.position = 'none')
ggplot(data = x, mapping = aes(x = Reference, y = Prediction)) +
geom_tile(aes(fill = Freq), colour = 'white') +
geom_text(aes(label = sprintf('%1.0f', Freq)), vjust = 1) +
scale_fill_gradient(low = 'blue', high = 'green') +
theme_bw() + theme(legend.position = 'none')
ggplot(data = x, mapping = aes(x = Reference, y = Prediction)) +
geom_tile(aes(fill = Freq), colour = 'white') +
geom_text(aes(label = sprintf('%1.0f', Freq)), vjust = 1) +
scale_fill_gradient(low = 'red', high = 'green') +
theme_bw() + theme(legend.position = 'none')
ggplot(data = x, mapping = aes(x = Reference, y = Prediction)) +
geom_tile(aes(fill = Freq), colour = 'blue') +
geom_text(aes(label = sprintf('%1.0f', Freq)), vjust = 1) +
scale_fill_gradient(low = 'red', high = 'green') +
theme_bw() + theme(legend.position = 'none')
ggplot(data = x, mapping = aes(x = Reference, y = Prediction)) +
geom_tile(aes(fill = Freq), colour = 'white') +
geom_text(aes(label = sprintf('%1.0f', Freq)), vjust = 1) +
scale_fill_gradient(low = 'red', high = 'green') +
theme_bw() + theme(legend.position = 'none')
?scale_fill_gradient
ggplot(data = x, mapping = aes(x = Reference, y = Prediction)) +
geom_tile(aes(fill = Freq), colour = 'white') +
geom_text(aes(label = sprintf('%1.0f', Freq)), vjust = 1) +
scale_fill_gradient(low = 'black', high = 'green') +
theme_bw() + theme(legend.position = 'none')
ggplot(data = x, mapping = aes(x = Reference, y = Prediction)) +
geom_tile(aes(fill = Freq), colour = 'white') +
geom_text(aes(label = sprintf('%1.0f', Freq)), vjust = 1) +
scale_fill_gradient(low = 'white', high = 'green') +
theme_bw() + theme(legend.position = 'none')
load('model_nnet.rda')
# Carregando pacotes --------------------------------------------------------------------------------------
library(dplyr)
library(tidyr)
library(rvest)
library(quantmod)
library(httr)
library(tibble)
library(stringr)
library(neuralnet)
library(caret)
library(ggplot2)
plot(n)
# Carregando pacotes --------------------------------------------------------------------------------------
library(dplyr)
library(tidyr)
library(rvest)
library(quantmod)
library(httr)
library(tibble)
library(stringr)
library(neuralnet)
library(caret)
library(ggplot2)
?neuralnet
?scale
# Carregando pacotes --------------------------------------------------------------------------------------
library(rvest)
library(quantmod)
library(httr)
library(tibble)
library(stringr)
library(reshape2)
library(tidyverse)
library(neuralnet)
library(readr)
library(purrr)
historico <- read.csv2('csv/historico_formatado.csv') %>% dplyr::select(-X)
teste <- array(historico, dim = c(10, 10, 11767))
View(teste)
teste[1]
?array
teste <- array(data = historico, dim = c(10, 10, 10))
View(teste)
teste <- array(data = historico, dim = c(10, 10))
View(teste)
View(teste)
View(teste)
View(teste)
teste[1]
?dim
